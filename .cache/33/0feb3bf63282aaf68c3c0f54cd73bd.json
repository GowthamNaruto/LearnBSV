{"id":"gISk","dependencies":[{"name":"D:\\Aruljothi\\Learning-01\\new\\The Complete-node bootcamp\\complete-node-bootcamp-master\\4-natours\\learnBSV\\package.json","includedInParent":true,"mtime":1657948684510},{"name":"mongoose","loc":{"line":1,"column":25,"index":25},"parent":"D:\\Aruljothi\\Learning-01\\new\\The Complete-node bootcamp\\complete-node-bootcamp-master\\4-natours\\learnBSV\\models\\tourModel.js","resolved":"D:\\Aruljothi\\Learning-01\\new\\The Complete-node bootcamp\\complete-node-bootcamp-master\\4-natours\\learnBSV\\node_modules\\mongoose\\dist\\browser.umd.js"},{"name":"slugify","loc":{"line":2,"column":24,"index":63},"parent":"D:\\Aruljothi\\Learning-01\\new\\The Complete-node bootcamp\\complete-node-bootcamp-master\\4-natours\\learnBSV\\models\\tourModel.js","resolved":"D:\\Aruljothi\\Learning-01\\new\\The Complete-node bootcamp\\complete-node-bootcamp-master\\4-natours\\learnBSV\\node_modules\\slugify\\slugify.js"},{"name":"validator","loc":{"line":3,"column":26,"index":102},"parent":"D:\\Aruljothi\\Learning-01\\new\\The Complete-node bootcamp\\complete-node-bootcamp-master\\4-natours\\learnBSV\\models\\tourModel.js","resolved":"D:\\Aruljothi\\Learning-01\\new\\The Complete-node bootcamp\\complete-node-bootcamp-master\\4-natours\\learnBSV\\node_modules\\validator\\index.js"}],"generated":{"js":"var e=require(\"mongoose\"),t=require(\"slugify\"),r=require(\"validator\"),i=new e.Schema({name:{type:String,reruired:[!0,\"A tour must have a name\"],unique:!0,trim:!0,maxlength:[40,\"A tour must have less then or equal to 40 character\"],minlength:[10,\"A tour must have more then or equal to 10 character\"]},slug:String,duration:{type:Number,required:[!0,\"A tour must have a duration\"]},maxGroupSize:{type:Number,required:[!0,\"A tour must have a maxGroupSize\"]},difficulty:{type:String,required:[!0,\"A tour must have a difficulty\"],enum:{values:[\"easy\",\"medium\",\"difficult\"],message:\"Difficulty is either: easy, medium, difficult\"}},ratingsAverage:{type:Number,default:4.5,min:[1,\"Rating must be above 1.0\"],max:[5,\"Rating must be below 5.0\"],set:function(e){return Math.round(10*e)/10}},ratingsQuantity:{type:Number,default:0},price:{type:Number,required:[!0,\"A tour must have a price\"]},priceDiscount:{type:Number,validate:{validator:function(e){return e<this.price},message:\"Discount price ({VALUE}) should be below regular price\"}},summery:{type:String,trim:!0},description:{type:String,trim:!0},imageCover:{type:String,required:[!0,\"A tour must have a cover image\"]},images:[String],createdAt:{type:Date,default:Date.now(),select:!1},startDates:[Date],secretTour:{type:Boolean,default:!1},startLocation:{type:{type:String,default:\"Point\",enum:[\"Point\"]},coordinates:[Number],address:String,description:String},locations:[{type:{type:String,default:\"Point\",enum:[\"Point\"]},coordinates:[Number],address:String,description:String,day:Number}],guides:[{type:e.Schema.ObjectId,ref:\"User\"}]},{toJSON:{virtuals:!0},toObject:{virtuals:!0}});i.index({price:1,ratingsAverage:-1}),i.index({slug:1}),i.index({startLocation:\"2dsphere\"}),i.virtual(\"durationWeeks\").get(function(){return this.duration/7}),i.virtual(\"reviews\",{ref:\"Review\",foreignField:\"tour\",localField:\"_id\"}),i.pre(\"save\",function(e){this.slug=t(this.name,{lower:!0}),e()}),i.pre(/^find/,function(e){this.find({secretTour:{$ne:!0}}),this.start=Date.now(),e()}),i.pre(/^find/,function(e){this.populate({path:\"guides\",select:\"-__v -passwordChangedAt\"}),e()});var a=e.model(\"Tour\",i);module.exports=a;"},"sourceMaps":{"js":{"mappings":[{"source":"../../models/tourModel.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../../models/tourModel.js","name":"mongoose","original":{"line":1,"column":6},"generated":{"line":1,"column":4}},{"source":"../../models/tourModel.js","name":"require","original":{"line":1,"column":17},"generated":{"line":1,"column":6}},{"source":"../../models/tourModel.js","original":{"line":1,"column":25},"generated":{"line":1,"column":14}},{"source":"../../models/tourModel.js","name":"slugify","original":{"line":2,"column":6},"generated":{"line":1,"column":26}},{"source":"../../models/tourModel.js","name":"require","original":{"line":2,"column":16},"generated":{"line":1,"column":28}},{"source":"../../models/tourModel.js","original":{"line":2,"column":24},"generated":{"line":1,"column":36}},{"source":"../../models/tourModel.js","name":"validator","original":{"line":3,"column":6},"generated":{"line":1,"column":47}},{"source":"../../models/tourModel.js","name":"require","original":{"line":3,"column":18},"generated":{"line":1,"column":49}},{"source":"../../models/tourModel.js","original":{"line":3,"column":26},"generated":{"line":1,"column":57}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":6,"column":6},"generated":{"line":1,"column":70}},{"source":"../../models/tourModel.js","original":{"line":6,"column":19},"generated":{"line":1,"column":72}},{"source":"../../models/tourModel.js","name":"mongoose","original":{"line":6,"column":23},"generated":{"line":1,"column":76}},{"source":"../../models/tourModel.js","name":"Schema","original":{"line":6,"column":32},"generated":{"line":1,"column":78}},{"source":"../../models/tourModel.js","original":{"line":7,"column":2},"generated":{"line":1,"column":85}},{"source":"../../models/tourModel.js","name":"name","original":{"line":8,"column":4},"generated":{"line":1,"column":86}},{"source":"../../models/tourModel.js","original":{"line":8,"column":10},"generated":{"line":1,"column":91}},{"source":"../../models/tourModel.js","name":"type","original":{"line":9,"column":6},"generated":{"line":1,"column":92}},{"source":"../../models/tourModel.js","name":"String","original":{"line":9,"column":12},"generated":{"line":1,"column":97}},{"source":"../../models/tourModel.js","name":"reruired","original":{"line":10,"column":6},"generated":{"line":1,"column":104}},{"source":"../../models/tourModel.js","original":{"line":10,"column":16},"generated":{"line":1,"column":113}},{"source":"../../models/tourModel.js","original":{"line":10,"column":17},"generated":{"line":1,"column":115}},{"source":"../../models/tourModel.js","original":{"line":10,"column":23},"generated":{"line":1,"column":117}},{"source":"../../models/tourModel.js","name":"unique","original":{"line":11,"column":6},"generated":{"line":1,"column":144}},{"source":"../../models/tourModel.js","original":{"line":11,"column":14},"generated":{"line":1,"column":152}},{"source":"../../models/tourModel.js","name":"trim","original":{"line":12,"column":6},"generated":{"line":1,"column":154}},{"source":"../../models/tourModel.js","original":{"line":12,"column":12},"generated":{"line":1,"column":160}},{"source":"../../models/tourModel.js","name":"maxlength","original":{"line":13,"column":6},"generated":{"line":1,"column":162}},{"source":"../../models/tourModel.js","original":{"line":13,"column":17},"generated":{"line":1,"column":172}},{"source":"../../models/tourModel.js","original":{"line":13,"column":18},"generated":{"line":1,"column":173}},{"source":"../../models/tourModel.js","original":{"line":13,"column":22},"generated":{"line":1,"column":176}},{"source":"../../models/tourModel.js","name":"minlength","original":{"line":14,"column":6},"generated":{"line":1,"column":231}},{"source":"../../models/tourModel.js","original":{"line":14,"column":17},"generated":{"line":1,"column":241}},{"source":"../../models/tourModel.js","original":{"line":14,"column":18},"generated":{"line":1,"column":242}},{"source":"../../models/tourModel.js","original":{"line":14,"column":22},"generated":{"line":1,"column":245}},{"source":"../../models/tourModel.js","name":"slug","original":{"line":17,"column":4},"generated":{"line":1,"column":301}},{"source":"../../models/tourModel.js","name":"String","original":{"line":17,"column":10},"generated":{"line":1,"column":306}},{"source":"../../models/tourModel.js","name":"duration","original":{"line":18,"column":4},"generated":{"line":1,"column":313}},{"source":"../../models/tourModel.js","original":{"line":18,"column":14},"generated":{"line":1,"column":322}},{"source":"../../models/tourModel.js","name":"type","original":{"line":19,"column":6},"generated":{"line":1,"column":323}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":19,"column":12},"generated":{"line":1,"column":328}},{"source":"../../models/tourModel.js","name":"required","original":{"line":20,"column":6},"generated":{"line":1,"column":335}},{"source":"../../models/tourModel.js","original":{"line":20,"column":16},"generated":{"line":1,"column":344}},{"source":"../../models/tourModel.js","original":{"line":20,"column":17},"generated":{"line":1,"column":346}},{"source":"../../models/tourModel.js","original":{"line":20,"column":23},"generated":{"line":1,"column":348}},{"source":"../../models/tourModel.js","name":"maxGroupSize","original":{"line":22,"column":4},"generated":{"line":1,"column":380}},{"source":"../../models/tourModel.js","original":{"line":22,"column":18},"generated":{"line":1,"column":393}},{"source":"../../models/tourModel.js","name":"type","original":{"line":23,"column":6},"generated":{"line":1,"column":394}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":23,"column":12},"generated":{"line":1,"column":399}},{"source":"../../models/tourModel.js","name":"required","original":{"line":24,"column":6},"generated":{"line":1,"column":406}},{"source":"../../models/tourModel.js","original":{"line":24,"column":16},"generated":{"line":1,"column":415}},{"source":"../../models/tourModel.js","original":{"line":24,"column":17},"generated":{"line":1,"column":417}},{"source":"../../models/tourModel.js","original":{"line":24,"column":23},"generated":{"line":1,"column":419}},{"source":"../../models/tourModel.js","name":"difficulty","original":{"line":26,"column":4},"generated":{"line":1,"column":455}},{"source":"../../models/tourModel.js","original":{"line":26,"column":16},"generated":{"line":1,"column":466}},{"source":"../../models/tourModel.js","name":"type","original":{"line":27,"column":6},"generated":{"line":1,"column":467}},{"source":"../../models/tourModel.js","name":"String","original":{"line":27,"column":12},"generated":{"line":1,"column":472}},{"source":"../../models/tourModel.js","name":"required","original":{"line":28,"column":6},"generated":{"line":1,"column":479}},{"source":"../../models/tourModel.js","original":{"line":28,"column":16},"generated":{"line":1,"column":488}},{"source":"../../models/tourModel.js","original":{"line":28,"column":17},"generated":{"line":1,"column":490}},{"source":"../../models/tourModel.js","original":{"line":28,"column":23},"generated":{"line":1,"column":492}},{"source":"../../models/tourModel.js","name":"enum","original":{"line":29,"column":6},"generated":{"line":1,"column":525}},{"source":"../../models/tourModel.js","original":{"line":29,"column":12},"generated":{"line":1,"column":530}},{"source":"../../models/tourModel.js","name":"values","original":{"line":30,"column":8},"generated":{"line":1,"column":531}},{"source":"../../models/tourModel.js","original":{"line":30,"column":16},"generated":{"line":1,"column":538}},{"source":"../../models/tourModel.js","original":{"line":30,"column":17},"generated":{"line":1,"column":539}},{"source":"../../models/tourModel.js","original":{"line":30,"column":25},"generated":{"line":1,"column":546}},{"source":"../../models/tourModel.js","original":{"line":30,"column":35},"generated":{"line":1,"column":555}},{"source":"../../models/tourModel.js","name":"message","original":{"line":31,"column":8},"generated":{"line":1,"column":568}},{"source":"../../models/tourModel.js","original":{"line":31,"column":17},"generated":{"line":1,"column":576}},{"source":"../../models/tourModel.js","name":"ratingsAverage","original":{"line":34,"column":4},"generated":{"line":1,"column":626}},{"source":"../../models/tourModel.js","original":{"line":34,"column":20},"generated":{"line":1,"column":641}},{"source":"../../models/tourModel.js","name":"type","original":{"line":35,"column":6},"generated":{"line":1,"column":642}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":35,"column":12},"generated":{"line":1,"column":647}},{"source":"../../models/tourModel.js","name":"default","original":{"line":36,"column":6},"generated":{"line":1,"column":654}},{"source":"../../models/tourModel.js","original":{"line":36,"column":15},"generated":{"line":1,"column":662}},{"source":"../../models/tourModel.js","name":"min","original":{"line":37,"column":6},"generated":{"line":1,"column":666}},{"source":"../../models/tourModel.js","original":{"line":37,"column":11},"generated":{"line":1,"column":670}},{"source":"../../models/tourModel.js","original":{"line":37,"column":12},"generated":{"line":1,"column":671}},{"source":"../../models/tourModel.js","original":{"line":37,"column":15},"generated":{"line":1,"column":673}},{"source":"../../models/tourModel.js","name":"max","original":{"line":38,"column":6},"generated":{"line":1,"column":701}},{"source":"../../models/tourModel.js","original":{"line":38,"column":11},"generated":{"line":1,"column":705}},{"source":"../../models/tourModel.js","original":{"line":38,"column":12},"generated":{"line":1,"column":706}},{"source":"../../models/tourModel.js","original":{"line":38,"column":15},"generated":{"line":1,"column":708}},{"source":"../../models/tourModel.js","name":"set","original":{"line":39,"column":6},"generated":{"line":1,"column":736}},{"source":"../../models/tourModel.js","original":{"line":39,"column":11},"generated":{"line":1,"column":740}},{"source":"../../models/tourModel.js","name":"val","original":{"line":39,"column":12},"generated":{"line":1,"column":749}},{"source":"../../models/tourModel.js","original":{"line":39,"column":11},"generated":{"line":1,"column":752}},{"source":"../../models/tourModel.js","name":"Math","original":{"line":39,"column":20},"generated":{"line":1,"column":759}},{"source":"../../models/tourModel.js","name":"round","original":{"line":39,"column":25},"generated":{"line":1,"column":764}},{"source":"../../models/tourModel.js","original":{"line":39,"column":37},"generated":{"line":1,"column":770}},{"source":"../../models/tourModel.js","name":"val","original":{"line":39,"column":31},"generated":{"line":1,"column":773}},{"source":"../../models/tourModel.js","original":{"line":39,"column":43},"generated":{"line":1,"column":776}},{"source":"../../models/tourModel.js","name":"ratingsQuantity","original":{"line":41,"column":4},"generated":{"line":1,"column":781}},{"source":"../../models/tourModel.js","original":{"line":41,"column":21},"generated":{"line":1,"column":797}},{"source":"../../models/tourModel.js","name":"type","original":{"line":42,"column":6},"generated":{"line":1,"column":798}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":42,"column":12},"generated":{"line":1,"column":803}},{"source":"../../models/tourModel.js","name":"default","original":{"line":43,"column":6},"generated":{"line":1,"column":810}},{"source":"../../models/tourModel.js","original":{"line":43,"column":15},"generated":{"line":1,"column":818}},{"source":"../../models/tourModel.js","name":"price","original":{"line":51,"column":4},"generated":{"line":1,"column":821}},{"source":"../../models/tourModel.js","original":{"line":51,"column":11},"generated":{"line":1,"column":827}},{"source":"../../models/tourModel.js","name":"type","original":{"line":52,"column":6},"generated":{"line":1,"column":828}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":52,"column":12},"generated":{"line":1,"column":833}},{"source":"../../models/tourModel.js","name":"required","original":{"line":53,"column":6},"generated":{"line":1,"column":840}},{"source":"../../models/tourModel.js","original":{"line":53,"column":16},"generated":{"line":1,"column":849}},{"source":"../../models/tourModel.js","original":{"line":53,"column":17},"generated":{"line":1,"column":851}},{"source":"../../models/tourModel.js","original":{"line":53,"column":23},"generated":{"line":1,"column":853}},{"source":"../../models/tourModel.js","name":"priceDiscount","original":{"line":55,"column":4},"generated":{"line":1,"column":882}},{"source":"../../models/tourModel.js","original":{"line":55,"column":19},"generated":{"line":1,"column":896}},{"source":"../../models/tourModel.js","name":"type","original":{"line":56,"column":6},"generated":{"line":1,"column":897}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":56,"column":12},"generated":{"line":1,"column":902}},{"source":"../../models/tourModel.js","name":"validate","original":{"line":57,"column":6},"generated":{"line":1,"column":909}},{"source":"../../models/tourModel.js","original":{"line":57,"column":16},"generated":{"line":1,"column":918}},{"source":"../../models/tourModel.js","name":"validator","original":{"line":59,"column":8},"generated":{"line":1,"column":919}},{"source":"../../models/tourModel.js","original":{"line":59,"column":19},"generated":{"line":1,"column":929}},{"source":"../../models/tourModel.js","name":"val","original":{"line":59,"column":29},"generated":{"line":1,"column":938}},{"source":"../../models/tourModel.js","original":{"line":60,"column":10},"generated":{"line":1,"column":941}},{"source":"../../models/tourModel.js","name":"val","original":{"line":60,"column":17},"generated":{"line":1,"column":948}},{"source":"../../models/tourModel.js","original":{"line":60,"column":23},"generated":{"line":1,"column":950}},{"source":"../../models/tourModel.js","name":"price","original":{"line":60,"column":28},"generated":{"line":1,"column":955}},{"source":"../../models/tourModel.js","name":"message","original":{"line":62,"column":8},"generated":{"line":1,"column":962}},{"source":"../../models/tourModel.js","original":{"line":62,"column":17},"generated":{"line":1,"column":970}},{"source":"../../models/tourModel.js","name":"summery","original":{"line":65,"column":4},"generated":{"line":1,"column":1029}},{"source":"../../models/tourModel.js","original":{"line":65,"column":13},"generated":{"line":1,"column":1037}},{"source":"../../models/tourModel.js","name":"type","original":{"line":66,"column":6},"generated":{"line":1,"column":1038}},{"source":"../../models/tourModel.js","name":"String","original":{"line":66,"column":12},"generated":{"line":1,"column":1043}},{"source":"../../models/tourModel.js","name":"trim","original":{"line":67,"column":6},"generated":{"line":1,"column":1050}},{"source":"../../models/tourModel.js","original":{"line":67,"column":12},"generated":{"line":1,"column":1056}},{"source":"../../models/tourModel.js","name":"description","original":{"line":69,"column":4},"generated":{"line":1,"column":1059}},{"source":"../../models/tourModel.js","original":{"line":69,"column":17},"generated":{"line":1,"column":1071}},{"source":"../../models/tourModel.js","name":"type","original":{"line":70,"column":6},"generated":{"line":1,"column":1072}},{"source":"../../models/tourModel.js","name":"String","original":{"line":70,"column":12},"generated":{"line":1,"column":1077}},{"source":"../../models/tourModel.js","name":"trim","original":{"line":71,"column":6},"generated":{"line":1,"column":1084}},{"source":"../../models/tourModel.js","original":{"line":71,"column":12},"generated":{"line":1,"column":1090}},{"source":"../../models/tourModel.js","name":"imageCover","original":{"line":73,"column":4},"generated":{"line":1,"column":1093}},{"source":"../../models/tourModel.js","original":{"line":73,"column":16},"generated":{"line":1,"column":1104}},{"source":"../../models/tourModel.js","name":"type","original":{"line":74,"column":6},"generated":{"line":1,"column":1105}},{"source":"../../models/tourModel.js","name":"String","original":{"line":74,"column":12},"generated":{"line":1,"column":1110}},{"source":"../../models/tourModel.js","name":"required","original":{"line":75,"column":6},"generated":{"line":1,"column":1117}},{"source":"../../models/tourModel.js","original":{"line":75,"column":16},"generated":{"line":1,"column":1126}},{"source":"../../models/tourModel.js","original":{"line":75,"column":17},"generated":{"line":1,"column":1128}},{"source":"../../models/tourModel.js","original":{"line":75,"column":23},"generated":{"line":1,"column":1130}},{"source":"../../models/tourModel.js","name":"images","original":{"line":77,"column":4},"generated":{"line":1,"column":1165}},{"source":"../../models/tourModel.js","original":{"line":77,"column":12},"generated":{"line":1,"column":1172}},{"source":"../../models/tourModel.js","name":"String","original":{"line":77,"column":13},"generated":{"line":1,"column":1173}},{"source":"../../models/tourModel.js","name":"createdAt","original":{"line":78,"column":4},"generated":{"line":1,"column":1181}},{"source":"../../models/tourModel.js","original":{"line":78,"column":15},"generated":{"line":1,"column":1191}},{"source":"../../models/tourModel.js","name":"type","original":{"line":79,"column":6},"generated":{"line":1,"column":1192}},{"source":"../../models/tourModel.js","name":"Date","original":{"line":79,"column":12},"generated":{"line":1,"column":1197}},{"source":"../../models/tourModel.js","name":"default","original":{"line":80,"column":6},"generated":{"line":1,"column":1202}},{"source":"../../models/tourModel.js","name":"Date","original":{"line":80,"column":15},"generated":{"line":1,"column":1210}},{"source":"../../models/tourModel.js","name":"now","original":{"line":80,"column":20},"generated":{"line":1,"column":1215}},{"source":"../../models/tourModel.js","name":"select","original":{"line":81,"column":6},"generated":{"line":1,"column":1221}},{"source":"../../models/tourModel.js","original":{"line":81,"column":14},"generated":{"line":1,"column":1229}},{"source":"../../models/tourModel.js","name":"startDates","original":{"line":83,"column":4},"generated":{"line":1,"column":1232}},{"source":"../../models/tourModel.js","original":{"line":83,"column":16},"generated":{"line":1,"column":1243}},{"source":"../../models/tourModel.js","name":"Date","original":{"line":83,"column":17},"generated":{"line":1,"column":1244}},{"source":"../../models/tourModel.js","name":"secretTour","original":{"line":84,"column":4},"generated":{"line":1,"column":1250}},{"source":"../../models/tourModel.js","original":{"line":84,"column":16},"generated":{"line":1,"column":1261}},{"source":"../../models/tourModel.js","name":"type","original":{"line":85,"column":6},"generated":{"line":1,"column":1262}},{"source":"../../models/tourModel.js","name":"Boolean","original":{"line":85,"column":12},"generated":{"line":1,"column":1267}},{"source":"../../models/tourModel.js","name":"default","original":{"line":86,"column":6},"generated":{"line":1,"column":1275}},{"source":"../../models/tourModel.js","original":{"line":86,"column":15},"generated":{"line":1,"column":1284}},{"source":"../../models/tourModel.js","name":"startLocation","original":{"line":88,"column":4},"generated":{"line":1,"column":1287}},{"source":"../../models/tourModel.js","original":{"line":88,"column":19},"generated":{"line":1,"column":1301}},{"source":"../../models/tourModel.js","name":"type","original":{"line":89,"column":6},"generated":{"line":1,"column":1302}},{"source":"../../models/tourModel.js","original":{"line":89,"column":12},"generated":{"line":1,"column":1307}},{"source":"../../models/tourModel.js","name":"type","original":{"line":90,"column":8},"generated":{"line":1,"column":1308}},{"source":"../../models/tourModel.js","name":"String","original":{"line":90,"column":14},"generated":{"line":1,"column":1313}},{"source":"../../models/tourModel.js","name":"default","original":{"line":91,"column":8},"generated":{"line":1,"column":1320}},{"source":"../../models/tourModel.js","original":{"line":91,"column":17},"generated":{"line":1,"column":1328}},{"source":"../../models/tourModel.js","name":"enum","original":{"line":92,"column":8},"generated":{"line":1,"column":1336}},{"source":"../../models/tourModel.js","original":{"line":92,"column":14},"generated":{"line":1,"column":1341}},{"source":"../../models/tourModel.js","original":{"line":92,"column":15},"generated":{"line":1,"column":1342}},{"source":"../../models/tourModel.js","name":"coordinates","original":{"line":94,"column":6},"generated":{"line":1,"column":1352}},{"source":"../../models/tourModel.js","original":{"line":94,"column":19},"generated":{"line":1,"column":1364}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":94,"column":20},"generated":{"line":1,"column":1365}},{"source":"../../models/tourModel.js","name":"address","original":{"line":95,"column":6},"generated":{"line":1,"column":1373}},{"source":"../../models/tourModel.js","name":"String","original":{"line":95,"column":15},"generated":{"line":1,"column":1381}},{"source":"../../models/tourModel.js","name":"description","original":{"line":96,"column":6},"generated":{"line":1,"column":1388}},{"source":"../../models/tourModel.js","name":"String","original":{"line":96,"column":19},"generated":{"line":1,"column":1400}},{"source":"../../models/tourModel.js","name":"locations","original":{"line":98,"column":4},"generated":{"line":1,"column":1408}},{"source":"../../models/tourModel.js","original":{"line":98,"column":15},"generated":{"line":1,"column":1418}},{"source":"../../models/tourModel.js","original":{"line":99,"column":6},"generated":{"line":1,"column":1419}},{"source":"../../models/tourModel.js","name":"type","original":{"line":100,"column":8},"generated":{"line":1,"column":1420}},{"source":"../../models/tourModel.js","original":{"line":100,"column":14},"generated":{"line":1,"column":1425}},{"source":"../../models/tourModel.js","name":"type","original":{"line":101,"column":10},"generated":{"line":1,"column":1426}},{"source":"../../models/tourModel.js","name":"String","original":{"line":101,"column":16},"generated":{"line":1,"column":1431}},{"source":"../../models/tourModel.js","name":"default","original":{"line":102,"column":10},"generated":{"line":1,"column":1438}},{"source":"../../models/tourModel.js","original":{"line":102,"column":19},"generated":{"line":1,"column":1446}},{"source":"../../models/tourModel.js","name":"enum","original":{"line":103,"column":10},"generated":{"line":1,"column":1454}},{"source":"../../models/tourModel.js","original":{"line":103,"column":16},"generated":{"line":1,"column":1459}},{"source":"../../models/tourModel.js","original":{"line":103,"column":17},"generated":{"line":1,"column":1460}},{"source":"../../models/tourModel.js","name":"coordinates","original":{"line":105,"column":8},"generated":{"line":1,"column":1470}},{"source":"../../models/tourModel.js","original":{"line":105,"column":21},"generated":{"line":1,"column":1482}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":105,"column":22},"generated":{"line":1,"column":1483}},{"source":"../../models/tourModel.js","name":"address","original":{"line":106,"column":8},"generated":{"line":1,"column":1491}},{"source":"../../models/tourModel.js","name":"String","original":{"line":106,"column":17},"generated":{"line":1,"column":1499}},{"source":"../../models/tourModel.js","name":"description","original":{"line":107,"column":8},"generated":{"line":1,"column":1506}},{"source":"../../models/tourModel.js","name":"String","original":{"line":107,"column":21},"generated":{"line":1,"column":1518}},{"source":"../../models/tourModel.js","name":"day","original":{"line":108,"column":8},"generated":{"line":1,"column":1525}},{"source":"../../models/tourModel.js","name":"Number","original":{"line":108,"column":13},"generated":{"line":1,"column":1529}},{"source":"../../models/tourModel.js","name":"guides","original":{"line":111,"column":4},"generated":{"line":1,"column":1538}},{"source":"../../models/tourModel.js","original":{"line":111,"column":12},"generated":{"line":1,"column":1545}},{"source":"../../models/tourModel.js","original":{"line":112,"column":6},"generated":{"line":1,"column":1546}},{"source":"../../models/tourModel.js","name":"type","original":{"line":113,"column":8},"generated":{"line":1,"column":1547}},{"source":"../../models/tourModel.js","name":"mongoose","original":{"line":113,"column":14},"generated":{"line":1,"column":1552}},{"source":"../../models/tourModel.js","name":"Schema","original":{"line":113,"column":23},"generated":{"line":1,"column":1554}},{"source":"../../models/tourModel.js","name":"ObjectId","original":{"line":113,"column":30},"generated":{"line":1,"column":1561}},{"source":"../../models/tourModel.js","name":"ref","original":{"line":114,"column":8},"generated":{"line":1,"column":1570}},{"source":"../../models/tourModel.js","original":{"line":114,"column":13},"generated":{"line":1,"column":1574}},{"source":"../../models/tourModel.js","original":{"line":118,"column":2},"generated":{"line":1,"column":1584}},{"source":"../../models/tourModel.js","name":"toJSON","original":{"line":119,"column":4},"generated":{"line":1,"column":1585}},{"source":"../../models/tourModel.js","original":{"line":119,"column":12},"generated":{"line":1,"column":1592}},{"source":"../../models/tourModel.js","name":"virtuals","original":{"line":119,"column":14},"generated":{"line":1,"column":1593}},{"source":"../../models/tourModel.js","original":{"line":119,"column":24},"generated":{"line":1,"column":1603}},{"source":"../../models/tourModel.js","name":"toObject","original":{"line":120,"column":4},"generated":{"line":1,"column":1606}},{"source":"../../models/tourModel.js","original":{"line":120,"column":14},"generated":{"line":1,"column":1615}},{"source":"../../models/tourModel.js","name":"virtuals","original":{"line":120,"column":16},"generated":{"line":1,"column":1616}},{"source":"../../models/tourModel.js","original":{"line":120,"column":26},"generated":{"line":1,"column":1626}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":125,"column":0},"generated":{"line":1,"column":1631}},{"source":"../../models/tourModel.js","name":"index","original":{"line":125,"column":11},"generated":{"line":1,"column":1633}},{"source":"../../models/tourModel.js","original":{"line":125,"column":17},"generated":{"line":1,"column":1639}},{"source":"../../models/tourModel.js","name":"price","original":{"line":125,"column":19},"generated":{"line":1,"column":1640}},{"source":"../../models/tourModel.js","original":{"line":125,"column":26},"generated":{"line":1,"column":1646}},{"source":"../../models/tourModel.js","name":"ratingsAverage","original":{"line":125,"column":29},"generated":{"line":1,"column":1648}},{"source":"../../models/tourModel.js","original":{"line":125,"column":46},"generated":{"line":1,"column":1664}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":126,"column":0},"generated":{"line":1,"column":1668}},{"source":"../../models/tourModel.js","name":"index","original":{"line":126,"column":11},"generated":{"line":1,"column":1670}},{"source":"../../models/tourModel.js","original":{"line":126,"column":17},"generated":{"line":1,"column":1676}},{"source":"../../models/tourModel.js","name":"slug","original":{"line":126,"column":19},"generated":{"line":1,"column":1677}},{"source":"../../models/tourModel.js","original":{"line":126,"column":25},"generated":{"line":1,"column":1682}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":127,"column":0},"generated":{"line":1,"column":1686}},{"source":"../../models/tourModel.js","name":"index","original":{"line":127,"column":11},"generated":{"line":1,"column":1688}},{"source":"../../models/tourModel.js","original":{"line":127,"column":17},"generated":{"line":1,"column":1694}},{"source":"../../models/tourModel.js","name":"startLocation","original":{"line":127,"column":19},"generated":{"line":1,"column":1695}},{"source":"../../models/tourModel.js","original":{"line":127,"column":34},"generated":{"line":1,"column":1709}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":129,"column":0},"generated":{"line":1,"column":1722}},{"source":"../../models/tourModel.js","name":"virtual","original":{"line":129,"column":11},"generated":{"line":1,"column":1724}},{"source":"../../models/tourModel.js","original":{"line":129,"column":19},"generated":{"line":1,"column":1732}},{"source":"../../models/tourModel.js","name":"get","original":{"line":129,"column":36},"generated":{"line":1,"column":1749}},{"source":"../../models/tourModel.js","original":{"line":129,"column":40},"generated":{"line":1,"column":1753}},{"source":"../../models/tourModel.js","original":{"line":130,"column":2},"generated":{"line":1,"column":1764}},{"source":"../../models/tourModel.js","original":{"line":130,"column":9},"generated":{"line":1,"column":1771}},{"source":"../../models/tourModel.js","name":"duration","original":{"line":130,"column":14},"generated":{"line":1,"column":1776}},{"source":"../../models/tourModel.js","original":{"line":130,"column":25},"generated":{"line":1,"column":1785}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":134,"column":0},"generated":{"line":1,"column":1789}},{"source":"../../models/tourModel.js","name":"virtual","original":{"line":134,"column":11},"generated":{"line":1,"column":1791}},{"source":"../../models/tourModel.js","original":{"line":134,"column":19},"generated":{"line":1,"column":1799}},{"source":"../../models/tourModel.js","original":{"line":134,"column":30},"generated":{"line":1,"column":1809}},{"source":"../../models/tourModel.js","name":"ref","original":{"line":135,"column":2},"generated":{"line":1,"column":1810}},{"source":"../../models/tourModel.js","original":{"line":135,"column":7},"generated":{"line":1,"column":1814}},{"source":"../../models/tourModel.js","name":"foreignField","original":{"line":136,"column":2},"generated":{"line":1,"column":1823}},{"source":"../../models/tourModel.js","original":{"line":136,"column":16},"generated":{"line":1,"column":1836}},{"source":"../../models/tourModel.js","name":"localField","original":{"line":137,"column":2},"generated":{"line":1,"column":1843}},{"source":"../../models/tourModel.js","original":{"line":137,"column":14},"generated":{"line":1,"column":1854}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":141,"column":0},"generated":{"line":1,"column":1862}},{"source":"../../models/tourModel.js","name":"pre","original":{"line":141,"column":11},"generated":{"line":1,"column":1864}},{"source":"../../models/tourModel.js","original":{"line":141,"column":15},"generated":{"line":1,"column":1868}},{"source":"../../models/tourModel.js","original":{"line":141,"column":23},"generated":{"line":1,"column":1875}},{"source":"../../models/tourModel.js","name":"next","original":{"line":141,"column":33},"generated":{"line":1,"column":1884}},{"source":"../../models/tourModel.js","original":{"line":142,"column":2},"generated":{"line":1,"column":1887}},{"source":"../../models/tourModel.js","name":"slug","original":{"line":142,"column":7},"generated":{"line":1,"column":1892}},{"source":"../../models/tourModel.js","name":"slugify","original":{"line":142,"column":14},"generated":{"line":1,"column":1897}},{"source":"../../models/tourModel.js","original":{"line":142,"column":22},"generated":{"line":1,"column":1899}},{"source":"../../models/tourModel.js","name":"name","original":{"line":142,"column":27},"generated":{"line":1,"column":1904}},{"source":"../../models/tourModel.js","original":{"line":142,"column":33},"generated":{"line":1,"column":1909}},{"source":"../../models/tourModel.js","name":"lower","original":{"line":142,"column":35},"generated":{"line":1,"column":1910}},{"source":"../../models/tourModel.js","original":{"line":142,"column":42},"generated":{"line":1,"column":1917}},{"source":"../../models/tourModel.js","name":"next","original":{"line":143,"column":2},"generated":{"line":1,"column":1921}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":153,"column":0},"generated":{"line":1,"column":1927}},{"source":"../../models/tourModel.js","name":"pre","original":{"line":153,"column":11},"generated":{"line":1,"column":1929}},{"source":"../../models/tourModel.js","original":{"line":153,"column":15},"generated":{"line":1,"column":1933}},{"source":"../../models/tourModel.js","original":{"line":153,"column":24},"generated":{"line":1,"column":1941}},{"source":"../../models/tourModel.js","name":"next","original":{"line":153,"column":34},"generated":{"line":1,"column":1950}},{"source":"../../models/tourModel.js","original":{"line":154,"column":2},"generated":{"line":1,"column":1953}},{"source":"../../models/tourModel.js","name":"find","original":{"line":154,"column":7},"generated":{"line":1,"column":1958}},{"source":"../../models/tourModel.js","original":{"line":154,"column":12},"generated":{"line":1,"column":1963}},{"source":"../../models/tourModel.js","name":"secretTour","original":{"line":154,"column":14},"generated":{"line":1,"column":1964}},{"source":"../../models/tourModel.js","original":{"line":154,"column":26},"generated":{"line":1,"column":1975}},{"source":"../../models/tourModel.js","name":"$ne","original":{"line":154,"column":28},"generated":{"line":1,"column":1976}},{"source":"../../models/tourModel.js","original":{"line":154,"column":33},"generated":{"line":1,"column":1981}},{"source":"../../models/tourModel.js","original":{"line":155,"column":2},"generated":{"line":1,"column":1986}},{"source":"../../models/tourModel.js","name":"start","original":{"line":155,"column":7},"generated":{"line":1,"column":1991}},{"source":"../../models/tourModel.js","name":"Date","original":{"line":155,"column":15},"generated":{"line":1,"column":1997}},{"source":"../../models/tourModel.js","name":"now","original":{"line":155,"column":20},"generated":{"line":1,"column":2002}},{"source":"../../models/tourModel.js","name":"next","original":{"line":156,"column":2},"generated":{"line":1,"column":2008}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":159,"column":0},"generated":{"line":1,"column":2014}},{"source":"../../models/tourModel.js","name":"pre","original":{"line":159,"column":11},"generated":{"line":1,"column":2016}},{"source":"../../models/tourModel.js","original":{"line":159,"column":15},"generated":{"line":1,"column":2020}},{"source":"../../models/tourModel.js","original":{"line":159,"column":24},"generated":{"line":1,"column":2028}},{"source":"../../models/tourModel.js","name":"next","original":{"line":159,"column":34},"generated":{"line":1,"column":2037}},{"source":"../../models/tourModel.js","original":{"line":160,"column":2},"generated":{"line":1,"column":2040}},{"source":"../../models/tourModel.js","name":"populate","original":{"line":160,"column":7},"generated":{"line":1,"column":2045}},{"source":"../../models/tourModel.js","original":{"line":160,"column":16},"generated":{"line":1,"column":2054}},{"source":"../../models/tourModel.js","name":"path","original":{"line":161,"column":4},"generated":{"line":1,"column":2055}},{"source":"../../models/tourModel.js","original":{"line":161,"column":10},"generated":{"line":1,"column":2060}},{"source":"../../models/tourModel.js","name":"select","original":{"line":162,"column":4},"generated":{"line":1,"column":2069}},{"source":"../../models/tourModel.js","original":{"line":162,"column":12},"generated":{"line":1,"column":2076}},{"source":"../../models/tourModel.js","name":"next","original":{"line":165,"column":2},"generated":{"line":1,"column":2104}},{"source":"../../models/tourModel.js","original":{"line":185,"column":0},"generated":{"line":1,"column":2110}},{"source":"../../models/tourModel.js","name":"Tour","original":{"line":185,"column":6},"generated":{"line":1,"column":2114}},{"source":"../../models/tourModel.js","name":"mongoose","original":{"line":185,"column":13},"generated":{"line":1,"column":2116}},{"source":"../../models/tourModel.js","name":"model","original":{"line":185,"column":22},"generated":{"line":1,"column":2118}},{"source":"../../models/tourModel.js","original":{"line":185,"column":28},"generated":{"line":1,"column":2124}},{"source":"../../models/tourModel.js","name":"tourSchema","original":{"line":185,"column":36},"generated":{"line":1,"column":2131}},{"source":"../../models/tourModel.js","name":"module","original":{"line":187,"column":0},"generated":{"line":1,"column":2134}},{"source":"../../models/tourModel.js","name":"exports","original":{"line":187,"column":7},"generated":{"line":1,"column":2141}},{"source":"../../models/tourModel.js","name":"Tour","original":{"line":187,"column":17},"generated":{"line":1,"column":2149}}],"sources":{"../../models/tourModel.js":"const mongoose = require('mongoose');\r\nconst slugify = require('slugify');\r\nconst validator = require('validator');\r\n// const User = require('./userModel');\r\n\r\nconst tourSchema = new mongoose.Schema(\r\n  {\r\n    name: {\r\n      type: String,\r\n      reruired: [true, 'A tour must have a name'],\r\n      unique: true,\r\n      trim: true,\r\n      maxlength: [40, 'A tour must have less then or equal to 40 character'],\r\n      minlength: [10, 'A tour must have more then or equal to 10 character'],\r\n      // validate: [validator.isAlpha, 'Tour name must only contains characters'],\r\n    },\r\n    slug: String,\r\n    duration: {\r\n      type: Number,\r\n      required: [true, 'A tour must have a duration'],\r\n    },\r\n    maxGroupSize: {\r\n      type: Number,\r\n      required: [true, 'A tour must have a maxGroupSize'],\r\n    },\r\n    difficulty: {\r\n      type: String,\r\n      required: [true, 'A tour must have a difficulty'],\r\n      enum: {\r\n        values: ['easy', 'medium', 'difficult'],\r\n        message: 'Difficulty is either: easy, medium, difficult',\r\n      },\r\n    },\r\n    ratingsAverage: {\r\n      type: Number,\r\n      default: 4.5,\r\n      min: [1, 'Rating must be above 1.0'],\r\n      max: [5, 'Rating must be below 5.0'],\r\n      set: (val) => Math.round(val * 10) / 10,\r\n    },\r\n    ratingsQuantity: {\r\n      type: Number,\r\n      default: 0,\r\n    },\r\n    // rating: {\r\n    //   type: Number,\r\n    //   default: 0,\r\n    //   min: [1, 'Rating must be above 1.0'],\r\n    //   max: [5, 'Rating must be below 5.0'],\r\n    // },\r\n    price: {\r\n      type: Number,\r\n      required: [true, 'A tour must have a price'],\r\n    },\r\n    priceDiscount: {\r\n      type: Number,\r\n      validate: {\r\n        // this only points to current doc on NEW document creation\r\n        validator: function (val) {\r\n          return val < this.price;\r\n        },\r\n        message: 'Discount price ({VALUE}) should be below regular price',\r\n      },\r\n    },\r\n    summery: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    description: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    imageCover: {\r\n      type: String,\r\n      required: [true, 'A tour must have a cover image'],\r\n    },\r\n    images: [String],\r\n    createdAt: {\r\n      type: Date,\r\n      default: Date.now(),\r\n      select: false,\r\n    },\r\n    startDates: [Date],\r\n    secretTour: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    startLocation: {\r\n      type: {\r\n        type: String,\r\n        default: 'Point',\r\n        enum: ['Point'],\r\n      },\r\n      coordinates: [Number],\r\n      address: String,\r\n      description: String,\r\n    },\r\n    locations: [\r\n      {\r\n        type: {\r\n          type: String,\r\n          default: 'Point',\r\n          enum: ['Point'],\r\n        },\r\n        coordinates: [Number],\r\n        address: String,\r\n        description: String,\r\n        day: Number,\r\n      },\r\n    ],\r\n    guides: [\r\n      {\r\n        type: mongoose.Schema.ObjectId,\r\n        ref: 'User',\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    toJSON: { virtuals: true },\r\n    toObject: { virtuals: true },\r\n  }\r\n);\r\n\r\n// tourSchema.index({ price: 1 });\r\ntourSchema.index({ price: 1, ratingsAverage: -1 });\r\ntourSchema.index({ slug: 1 });\r\ntourSchema.index({ startLocation: '2dsphere' });\r\n\r\ntourSchema.virtual('durationWeeks').get(function () {\r\n  return this.duration / 7;\r\n});\r\n\r\n// Virtual populate\r\ntourSchema.virtual('reviews', {\r\n  ref: 'Review',\r\n  foreignField: 'tour',\r\n  localField: '_id',\r\n});\r\n\r\n// DOCUMENT MIDDLEWARE: runs before .save() and .create()\r\ntourSchema.pre('save', function (next) {\r\n  this.slug = slugify(this.name, { lower: true });\r\n  next();\r\n});\r\n\r\n// tourSchema.pre('save', async function (next) {\r\n//   const guidesPromises = this.guides.map(async (id) => await User.findById(id));\r\n//   this.guides = await Promise.all(guidesPromises);\r\n//   next();\r\n// });\r\n\r\n// QUERRY MIDDLEWARE\r\ntourSchema.pre(/^find/, function (next) {\r\n  this.find({ secretTour: { $ne: true } });\r\n  this.start = Date.now();\r\n  next();\r\n});\r\n\r\ntourSchema.pre(/^find/, function (next) {\r\n  this.populate({\r\n    path: 'guides',\r\n    select: '-__v -passwordChangedAt',\r\n  });\r\n\r\n  next();\r\n});\r\n\r\n// tourSchema.post(/^find/, function (docs, next) {\r\n//   console.log(`Query took ${Date.now() - this.start} milliseconds`);\r\n//   next();\r\n// });\r\n\r\n// AGGREDATION MIDDLEWARE\r\n// tourSchema.pre('aggregate', function (next) {\r\n//   this.pipeline().unshift({ $match: { secretTour: { $ne: true } } });\r\n//   console.log(this.pipeline());\r\n//   next();\r\n// });\r\n\r\n// tourSchema.post('save', function (doc, next) {\r\n//   console.log(doc);\r\n//   next();\r\n// });\r\n\r\nconst Tour = mongoose.model('Tour', tourSchema);\r\n\r\nmodule.exports = Tour;\r\n"},"lineCount":null}},"error":null,"hash":"e4cd7c835259103664e8aa1a8693b047","cacheData":{"env":{}}}